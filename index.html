<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jackie&#39;s Blog</title>
  <meta name="author" content="Jackie wu">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Jackie&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Jackie&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Jackie&#39;s Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-23T14:25:47.000Z"><a href="/2015/06/23/storm/">2015-06-23</a></time>
      
      
  
    <h1 class="title"><a href="/2015/06/23/storm/">Storm伪分布式单机环境</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Storm伪分布式单机环境安装，内容参考<em>Storm分布式实时计算模式</em>书中内容，进行搭建环境CentosZookeeper安装很简单参考官网进行下载：<a href="http://www.apache.org/dyn/closer.cgi/zookeeper/" target="_blank" rel="external">官网</a>Zookeeper的使用也很简单参考个<a href="http://zookeeper.apache.org/doc/r3.4.6/zookeeperStarted.html#sc_InstallingSingleMode" target="_blank" rel="external">官网文档</a>进行单机的Standalone配置。</p>
<ol>
<li><p>安装依赖包</p>
<p> yum install uuid*<br> yum install libtool<br> yum install libuuid<br> yum install libuuid-devel  </p>
</li>
<li><p>安装Git和Maven更新安装数据源</p>
<p> [root@git ~]# cd src/<br> [root@git src]# wget <a href="http://dl.fedoraproject.org/pub/epel/5/x86_64/epel-release-5-4.noarch.rpm" target="_blank" rel="external">http://dl.fedoraproject.org/pub/epel/5/x86_64/epel-release-5-4.noarch.rpm</a><br> [root@git src]# rpm -ivh epel-release-5-4.noarch.rpm<br> Preparing…                ########################################### [100%]</p>
<pre><code><span class="keyword">package</span> epel-<span class="keyword">release</span>-<span class="number">5</span>-<span class="number">4</span>.noarch <span class="keyword">is</span> already installed
</code></pre><p> [root@git ~]# yum list<br> [root@git ~]# yum install -y git<br>maven的yum安装参考Stackoverflow<a href="http://stackoverflow.com/questions/7532928/how-do-i-install-maven-with-yum" target="_blank" rel="external">问题</a></p>
<p> wget <a href="http://repos.fedorapeople.org/repos/dchen/apache-maven/epel-apache-maven.repo" target="_blank" rel="external">http://repos.fedorapeople.org/repos/dchen/apache-maven/epel-apache-maven.repo</a> -O /etc/yum.repos.d/epel-apache-maven.repo<br> yum install apache-maven<br>安装后发现mvn并没有加入到环境变量： </p>
<p> rpm -ql  apache（查找rpm包的安装路径）<br>export PATH=$PATH:/user/share/apache-maven/bin<br>启动Storm出现问题：<br>(注意yaml格式的要求,空格tab,:和-前后都有空格) 下面都是由于配置文件没有正确设置造成的</p>
<p>  in ‘reader’, line 27, column 1:<br> 　　- 6701<br>Storm运行：</p>
<ol>
<li>启动zookeeper<br> ./zkServer.sh start </li>
<li>启动nimbus 和Supervisor<br> storm nimbus &amp;<br> storm supervisor &amp; </li>
</ol>
</li>
<li><p>日志查看<br>zookeeper日志文件：　bin/ cat zookeeper.out 查看错误日志<br>storm错误日志：storm/logs 下面有nimbus和supervisor日志错误信息<br>但看到如下信息时nimbus就已经启动成功 </p>
<p> 3534 nimbus<br> 3514 QuorumPeerMain<br> 3591 Jps<br>试着访问本地地址： localhost:8080<br>发现不能访问，但是 netstat -ano |grep 8080看到8080端口正在运行中，所以怀疑是防火墙<br>问题iptables -F（关闭防火墙）重新访问,一切正常访问！搭建成功！</p>
</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-24T13:07:20.000Z"><a href="/2015/05/24/scrapy/">2015-05-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/24/scrapy/">scrapy学习</a></h1>
  

    </header>
    <div class="entry">
      
        <p>   由于数据分析需要使用twitter进行数据分析，于是考虑使用python的爬虫框架搭建Twitter的数据抓取功能，关于scrapy的使用和教程<a href="http://doc.scrapy.org/en/latest/intro/tutorial.html" target="_blank" rel="external">参考</a><br>  Scrapy的环境搭建参考教程使用</p>
<pre><code>pip <span class="keyword">install</span> scrapy 
</code></pre><p> 搭建好之后参考教程建立一个startup的项目，中间却出现</p>
<pre><code><span class="constant">ImportError</span><span class="symbol">:</span> <span class="constant">Error</span> loading object <span class="string">'scrapy.core.downloader.handlers.s3.S3DownloadHandler'</span><span class="symbol">:</span> <span class="constant">No</span> <span class="class"><span class="keyword">module</span> <span class="title">named</span> <span class="title">win32api</span></span>
分析确实pywin32找了半天资料最好解决方法：
</code></pre><p>　在下面地址下载相应的pywin32的win32包，发到python安装目录的Scripts下执行:<br>　  easy_install.exe  easy_install.exe pywin32-219.win32-py2.7.exe<br>完成后再议运行scrapy crawl dmoz运行成功！</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-19T06:46:10.000Z"><a href="/2015/04/19/android-blog-4/">2015-04-19</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/19/android-blog-4/">Android应用开发四</a></h1>
  

    </header>
    <div class="entry">
      
        <p>首先关于上次遇到的问题，就是使用jsoup抓取网页时候一直报错，后来查找发现<br>不能直接在Android的MainActivity线程中直接调用http请求，所以可以通过重新启动一个线程<br>来完成，同时需要进行多线程之间的通讯使用Message和Handler类实现进程之间的通信传送数据。代码参考</p>
<pre><code>mHandler = <span class="keyword">new</span> Handler() {    
            @Override    
            <span class="keyword">public</span> <span class="keyword">void</span> handleMessage(Message msg) {    
                myadapter=<span class="keyword">new</span>  MySimpleAdapter(MainActivity.<span class="keyword">this</span>,newsDataList,R.layout.data_list);
                listView.setAdapter(myadapter);  

                listView.setOnItemClickListener(<span class="keyword">new</span> OnItemClickListener(){

                    @Override
                    <span class="keyword">public</span> <span class="keyword">void</span> onItemClick(AdapterView&lt;?&gt; adapter, View v, <span class="built_in">int</span> position,
                            <span class="keyword">long</span> id) {
                        System.out.<span class="built_in">println</span>(v);
                        Item t = (Item)newsDataList.<span class="built_in">get</span>(position);
                        Intent it = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>,ItemDetail.class) ;
                        it.putExtra(<span class="string">"blog_id"</span>, t.getId());
                        MainActivity.<span class="keyword">this</span>.startActivity(it) ;

                    }

                });
            }    
        };    
        <span class="keyword">new</span> Thread(runnable).start();
Runnable runnable = <span class="keyword">new</span> Runnable(){
@Override
<span class="keyword">public</span> <span class="keyword">void</span> run() {
    <span class="keyword">String</span> blog_url = <span class="string">"http://blog.csdn.net/xxxx"</span>;
    Document doc =<span class="keyword">null</span>;
    <span class="keyword">try</span> {
        doc = Jsoup.connect(blog_url).userAgent(<span class="string">"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/27.0.1453.110 Safari/537.36"</span>).timeout(<span class="number">5000</span>).<span class="built_in">get</span>();
    } <span class="keyword">catch</span> (IOException e) {
        e.printStackTrace();
    }
    <span class="keyword">if</span>(doc !=<span class="keyword">null</span>){
        Elements news = doc.select(<span class="string">"#article_list span.link_title a"</span>);
        List&lt;Item&gt; blogs = <span class="keyword">new</span> ArrayList&lt;Item&gt;();
        <span class="keyword">for</span>(Element link: news){
            <span class="keyword">String</span> href = link.attr(<span class="string">"href"</span>);

            <span class="keyword">String</span> id = href.substring(href.length()-<span class="number">8</span>,href.length());
            Log.i(<span class="string">"id="</span>,id);
            Item item = <span class="keyword">new</span> Item(id,link.<span class="built_in">text</span>());
            newsDataList.<span class="built_in">add</span>(item);
        }
         mHandler.sendEmptyMessage(<span class="number">0</span>); 
    }<span class="keyword">else</span>{
        Log.i(<span class="string">"data="</span>, <span class="keyword">String</span>.valueOf(<span class="number">1234124</span>));
    }
}
};
</code></pre><p>然后把以前的进入主页面的Splash程序和使用ActionBar创建下拉菜单的操作也加进去,这个练手程序就到此为止了。上张图片吧。。<br><img src="/images/android/android_blog_4_1.png" alt="Alt text"></p>
<p><a href="http://pan.baidu.com/s/1jGA3oSA" target="_blank" rel="external">代码下载</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-19T06:44:53.000Z"><a href="/2015/04/19/android-blog-3/">2015-04-19</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/19/android-blog-3/">Android应用开发三</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="使用webview">使用webview</h3><p> 由于需要浏览网页内容所以，所以考虑使用webView直接加载原来网页中的内容来显示。<br> 网络因素所以使用本地的html文件加速文件的显示。<br> 一个小的技巧，使用顶部导航栏时，图标点击和不点击显示不同颜色可以设置一个html文件比如<br>main.xml文件</p>
<pre><code>&lt;ImageView
      android:<span class="variable">id=</span><span class="string">"@+id/news_detail_home"</span>
      android:<span class="variable">layout_width=</span><span class="string">"wrap_content"</span>
      android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
      android:<span class="variable">layout_gravity=</span><span class="string">"left|center"</span>
      android:<span class="variable">background=</span><span class="string">"@drawable/head_home"</span>
      android:<span class="variable">clickable=</span><span class="string">"true"</span> /&gt;
</code></pre><p>在drawable下建立home.xml文件和选择和正常的样式图片：</p>
<pre><code><span class="pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;<span class="title">selector</span>
  <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">android:state_focused</span>=<span class="value">"true"</span> <span class="attribute">android:drawable</span>=<span class="value">"@drawable/head_home_selected"</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">android:state_selected</span>=<span class="value">"true"</span> <span class="attribute">android:drawable</span>=<span class="value">"@drawable/head_home_selected"</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">android:state_pressed</span>=<span class="value">"true"</span> <span class="attribute">android:drawable</span>=<span class="value">"@drawable/head_home_selected"</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">item</span> <span class="attribute">android:drawable</span>=<span class="value">"@drawable/head_home_normal"</span> /&gt;</span>
<span class="tag">&lt;/<span class="title">selector</span>&gt;</span>
</code></pre><p>最后代码：</p>
<pre><code>&lt;LinearLayout xmlns:<span class="variable">android=</span><span class="string">"http://schemas.android.com/apk/res/android"</span>  
    xmlns:<span class="variable">tools=</span><span class="string">"http://schemas.android.com/tools"</span>
    android:<span class="variable">orientation=</span><span class="string">"vertical"</span>
    android:<span class="variable">layout_width=</span><span class="string">"fill_parent"</span>  
    android:<span class="variable">layout_height=</span><span class="string">"fill_parent"</span>  
    tools:<span class="variable">context=</span><span class="string">".MainActivity"</span> &gt;  
   &lt;FrameLayout
        android:<span class="variable">id=</span><span class="string">"@+id/news_detail_header"</span>
        android:<span class="variable">layout_width=</span><span class="string">"fill_parent"</span>
        android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
        android:<span class="variable">background=</span><span class="string">"@drawable/head_bg"</span>
        android:<span class="variable">gravity=</span><span class="string">"center_vertical"</span>
        android:<span class="variable">orientation=</span><span class="string">"horizontal"</span>
        android:<span class="variable">paddingLeft=</span><span class="string">"2dip"</span>
        android:<span class="variable">paddingRight=</span><span class="string">"2dip"</span> &gt;

        &lt;ImageView
            android:<span class="variable">id=</span><span class="string">"@+id/news_detail_home"</span>
            android:<span class="variable">layout_width=</span><span class="string">"wrap_content"</span>
            android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
            android:<span class="variable">layout_gravity=</span><span class="string">"left|center"</span>
            android:<span class="variable">background=</span><span class="string">"@drawable/head_home"</span>
            android:<span class="variable">clickable=</span><span class="string">"true"</span> /&gt;

    &lt;/FrameLayout&gt;
     &lt;WebView 
         android:<span class="variable">id=</span><span class="string">"@+id/webview"</span>
         android:<span class="variable">layout_width=</span><span class="string">"wrap_content"</span>
         android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
         /&gt;
&lt;/LinearLayout&gt;  
</code></pre><ul>
<li>ItemDetai.java文件</li>
</ul>
<pre><code><span class="keyword">package</span> com.example.blogapp;
<span class="keyword">import</span> android.app.<span class="type">Activity</span>;
<span class="keyword">import</span> android.content.<span class="type">Intent</span>;
<span class="keyword">import</span> android.os.<span class="type">Bundle</span>;
<span class="keyword">import</span> android.view.<span class="type">View</span>;
<span class="keyword">import</span> android.view.<span class="type">View</span>.<span class="type">OnClickListener</span>;
<span class="keyword">import</span> android.webkit.<span class="type">WebView</span>;
<span class="keyword">import</span> android.webkit.<span class="type">WebViewClient</span>;
<span class="keyword">import</span> android.widget.<span class="type">Button</span>;
<span class="keyword">import</span> android.widget.<span class="type">ImageView</span>;
<span class="keyword">import</span> android.widget.<span class="type">TextView</span>;
public <span class="class"><span class="keyword">class</span> <span class="title">ItemDetail</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">Activity</span> {</span>
    <span class="keyword">private</span> <span class="type">ImageView</span> <span class="type">Iv</span> ;
    <span class="keyword">private</span> <span class="type">TextView</span> tv ;
    <span class="keyword">private</span> <span class="type">WebView</span> wv ;
    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) {
        <span class="keyword">super</span>.onCreate(savedInstanceState);
        setContentView(<span class="type">R</span>.layout.detail_main);
        <span class="type">Intent</span> intent = getIntent();
        intent.getExtras();
        <span class="type">Bundle</span> data = intent.getExtras();
        <span class="type">String</span> id = data.getString(<span class="string">"blog_id"</span>);
        wv = (<span class="type">WebView</span>) <span class="keyword">this</span>.findViewById(<span class="type">R</span>.id.webview);
        wv.getSettings().setJavaScriptEnabled(<span class="literal">true</span>);  
        wv.loadUrl(<span class="string">"file:///android_asset/index.html"</span>);  
        wv.setWebViewClient(<span class="keyword">new</span> <span class="type">HelloWebViewClient</span> ()); 
        <span class="type">Iv</span> = (<span class="type">ImageView</span>)<span class="keyword">this</span>.findViewById(<span class="type">R</span>.id.news_detail_home);
        <span class="type">Iv</span>.setOnClickListener(<span class="keyword">new</span> <span class="type">OnClickListener</span>(){
            <span class="annotation">@Override</span>
            public void onClick(<span class="type">View</span> v) {
                <span class="type">Intent</span> it = <span class="keyword">new</span> <span class="type">Intent</span>(<span class="type">ItemDetail</span>.<span class="keyword">this</span>,<span class="type">MainActivity</span>.<span class="keyword">class</span>);
                <span class="type">ItemDetail</span>.<span class="keyword">this</span>.startActivity(it);
                <span class="type">ItemDetail</span>.<span class="keyword">this</span>.finish();
            }});
    }

     <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWebViewClient</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">WebViewClient</span> {</span>  
            public boolean shouldOverrideUrlLoading(<span class="type">WebView</span> view, <span class="type">String</span> url) {  
                view.loadUrl(url);  
                <span class="keyword">return</span> <span class="literal">true</span>;  
            }  
        }  

}
</code></pre><p>效果图：</p>
<p><img src="/images/android/android_blog_3_1.png" alt="Alt text"></p>
<p>完整代码下载：<a href="http://pan.baidu.com/s/13rJ8E" target="_blank" rel="external">百度云盘</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-19T06:39:52.000Z"><a href="/2015/04/19/android-blog-2/">2015-04-19</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/19/android-blog-2/">Android应用开发二</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="了解Activity">了解Activity</h3><p><img src="/images/android/android_blog_2.png" alt="Alt text"></p>
<h3 id="了解Intent">了解Intent</h3><p>  在一个项目之中，会由多个Activity程序所组成，那么此时，这多个Activity程序之间就需要进行通讯，而这之间的通讯就依靠Intent完成。<br><img src="/images/android/android_blog_2_2.png" alt="Alt text"><br>示例： </p>
<ul>
<li>MainActivity.java</li>
</ul>
<pre><code><span class="keyword">package</span> com.example.blogapp;
<span class="keyword">import</span> java.util.ArrayList;
<span class="keyword">import</span> java.util.List;
<span class="keyword">import</span> android.app.Activity;
<span class="keyword">import</span> android.content.Intent;
<span class="keyword">import</span> android.os.Bundle;
<span class="keyword">import</span> android.view.Menu;
<span class="keyword">import</span> android.view.View;
<span class="keyword">import</span> android.view.View.OnClickListener;
<span class="keyword">import</span> android.widget.Button;
<span class="keyword">import</span> android.widget.ListView;

<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>{

    <span class="keyword">private</span> Item item ;
    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Item&gt; newsDataList = <span class="keyword">new</span> ArrayList&lt;Item&gt;();
    <span class="keyword">private</span> ListView listView ;
    <span class="keyword">private</span> MySimpleAdapter myadapter ;
    <span class="keyword">private</span> Button btn ;
    <span class="annotation">@Override</span>
    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{
        <span class="keyword">super</span>.onCreate(savedInstanceState);

        setContentView(R.layout.main);
        <span class="keyword">this</span>.initNewsData();
        myadapter = <span class="keyword">new</span> MySimpleAdapter(MainActivity.<span class="keyword">this</span>, newsDataList,R.layout.data_list);  
        listView =(ListView) findViewById(R.id.listview);
        listView.setAdapter(myadapter);
        btn = (Button)<span class="keyword">this</span>.findViewById(R.id.btn);
        btn.setOnClickListener(<span class="keyword">new</span> OnClickListener(){
            <span class="annotation">@Override</span>
            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>{
                Intent it = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>,ItemDetail.class) ;
                MainActivity.<span class="keyword">this</span>.startActivity(it) ;    
            }


        });

    }
    <span class="annotation">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>{
        getMenuInflater().inflate(R.menu.main, menu);
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }
    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initNewsData</span><span class="params">()</span> </span>{
        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">20</span>; i++) {
            item = <span class="keyword">new</span> Item(<span class="string">"ID:"</span>+i,<span class="string">"标题"</span>+ i);
            newsDataList.add(item);
        }
    }

}
</code></pre><ul>
<li><p>AndroidManifest.xml添加Activity信息</p>
  <activity android:name="com.example.blogapp.ItemDetail" android:label="@string/app_name"><br>  </activity></li>
<li>ItemDetail.java</li>
</ul>
<pre><code><span class="keyword">package</span> com.example.blogapp;
<span class="keyword">import</span> android.app.<span class="type">Activity</span>;
<span class="keyword">import</span> android.content.<span class="type">Intent</span>;
<span class="keyword">import</span> android.os.<span class="type">Bundle</span>;
<span class="keyword">import</span> android.view.<span class="type">View</span>;
<span class="keyword">import</span> android.view.<span class="type">View</span>.<span class="type">OnClickListener</span>;
<span class="keyword">import</span> android.widget.<span class="type">Button</span>;
public <span class="class"><span class="keyword">class</span> <span class="title">ItemDetail</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">Activity</span> {</span>
<span class="keyword">private</span> <span class="type">Button</span> btn ;
<span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) {
    <span class="keyword">super</span>.onCreate(savedInstanceState);
    setContentView(<span class="type">R</span>.layout.detail_main);
    btn = (<span class="type">Button</span>)<span class="keyword">this</span>.findViewById(<span class="type">R</span>.id.back);
    btn.setOnClickListener(<span class="keyword">new</span> <span class="type">OnClickListener</span>(){
        <span class="annotation">@Override</span>
        public void onClick(<span class="type">View</span> v) {
            <span class="type">Intent</span> it = <span class="keyword">new</span> <span class="type">Intent</span>(<span class="type">ItemDetail</span>.<span class="keyword">this</span>,<span class="type">MainActivity</span>.<span class="keyword">class</span>);
            <span class="type">ItemDetail</span>.<span class="keyword">this</span>.startActivity(it);
            <span class="type">ItemDetail</span>.<span class="keyword">this</span>.finish();
        }});
};
}
</code></pre><p>配置文件就是添加了2个按钮来获取点击事件跳转Activity。</p>
<h3 id="实现Activity通信，传递信息">实现Activity通信，传递信息</h3><ul>
<li>MainActivity.java修改onCreate方法如下:</li>
</ul>
<pre><code><span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{
        <span class="keyword">super</span>.onCreate(savedInstanceState);

        setContentView(R.layout.main);
        <span class="keyword">this</span>.initNewsData();
        myadapter = <span class="keyword">new</span>   
        MySimpleAdapter(MainActivity.<span class="keyword">this</span>,newsDataList,R.layout.data_list);  
        listView =(ListView) findViewById(R.id.listview);
        listView.setAdapter(myadapter);
        listView.setOnItemClickListener(<span class="keyword">new</span> OnItemClickListener(){
            <span class="annotation">@Override</span>
            <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; adapter, View v, <span class="keyword">int</span> position,
                    <span class="keyword">long</span> id)</span> </span>{
                System.out.println(v);
                Item t = (Item)newsDataList.get(position);
                Intent it = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>,ItemDetail.class) ;
                it.putExtra(<span class="string">"blog_id"</span>, t.getId());
                MainActivity.<span class="keyword">this</span>.startActivity(it) ;
            }

        });

}
</code></pre><ul>
<li>ItemDetail.java修改onCreate方法如下:</li>
</ul>
<pre><code><span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{
    <span class="keyword">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.detail_main);
    Intent intent = getIntent();
    intent.getExtras();
    Bundle data = intent.getExtras();
    String id = data.getString(<span class="string">"blog_id"</span>);
    tv = (TextView) <span class="keyword">this</span>.findViewById(R.id.info);
    tv.setText(<span class="string">"接收到信息"</span>+id);
    btn = (Button)<span class="keyword">this</span>.findViewById(R.id.back);
    btn.setOnClickListener(<span class="keyword">new</span> OnClickListener(){

        <span class="annotation">@Override</span>
        <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>{
            Intent it = <span class="keyword">new</span> Intent(ItemDetail.<span class="keyword">this</span>,MainActivity.class);
            ItemDetail.<span class="keyword">this</span>.startActivity(it);
            ItemDetail.<span class="keyword">this</span>.finish();
        }});
}
</code></pre><ul>
<li>图示：</li>
</ul>
<p><img src="/images/android/android_blog_2_3.png" alt="Alt text"></p>
<ul>
<li>详情页：</li>
</ul>
<p><img src="/images/android/android_blog_2_4.png" alt="Alt text"></p>
<p>至此准备工作已经差不多了下面开始整合吧.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-19T06:35:46.000Z"><a href="/2015/04/19/android-blog-1/">2015-04-19</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/19/android-blog-1/">Android应用开发一</a></h1>
  

    </header>
    <div class="entry">
      
        <p>   学习Android已经有一段时间了，可是一直没有动手开发实际的应用，今天就简单的实践下使用android来抓取自己的博客在手机上查看。</p>
<h3 id="知识准备">知识准备</h3><ol>
<li>使用Jsoup抓取网页<br> Jsoup是一个很好用的java的库可以使用jsoup来抓取网页进行解析，jsoup提供了类似于jquery的元素查找的方法可以很方便解析HTML元素或者内容。详情请参考<a href="http://jsoup.org/" target="_blank" rel="external">jsoup</a>中内容进行参考。简单示例:</li>
</ol>
<pre><code>String blog_url = <span class="string">"http://blog.csdn.net/wujindou"</span>;
Document doc = Jsoup.connect(blog_url).
userAgent(<span class="string">"Mozilla"</span>).followRedirects(<span class="constant">true</span>).<span class="keyword">timeout</span>(<span class="number">10000</span>).<span class="keyword">get</span>();
Elements news = doc.select(<span class="string">"#article_list span.link_title a"</span>);
<span class="keyword">for</span>(Element link: news){
    String href = link.attr(<span class="string">"href"</span>);
    String <span class="property">id</span> = href.substring(href.<span class="property">length</span>()-<span class="number">8</span>,href.<span class="property">length</span>());
    System.out.println(<span class="property">id</span>);
    System.out.println(link.<span class="type">text</span>());
}
</code></pre><ol>
<li>编写自定义Adapter<br>使用ListView显示列表最简单的方法就是：定义item布局文件,然后使用Map建立组件之间的对应关系<br>比如:</li>
</ol>
<ul>
<li>定义各个item的布局文件data_list.xml<br><img src="/images/android/android_blog_1.png" alt="Alt text"></li>
<li>定义全局的布局文件main.xml<br><img src="/images/android/android_blog_2.jpg" alt="Alt text"></li>
<li>使用<br><img src="/images/android/android_blog_3.png" alt="Alt text"><br>这样写虽然可以但是结构不清晰而且如果数据的内容过多也不方便进行扩展了，所以考虑使用自定的Adapter来封装原始的SimpleAdapter类方便程序的扩展和实现。</li>
<li>首先编写Item类： </li>
</ul>
<pre><code><span class="keyword">public</span> <span class="keyword">class</span> Item {
    <span class="keyword">private</span> <span class="built_in">String</span> id;
    <span class="keyword">private</span> <span class="built_in">String</span> title;
    <span class="keyword">public</span> Item(<span class="built_in">String</span> id,<span class="built_in">String</span> title){
        <span class="keyword">this</span>.id = id ;
        <span class="keyword">this</span>.title = title;
    }
    <span class="keyword">public</span> <span class="built_in">String</span> getId() {
        <span class="keyword">return</span> id;
    }
    <span class="keyword">public</span> <span class="built_in">void</span> setId(<span class="built_in">String</span> id) {
        <span class="keyword">this</span>.id = id;
    }
    <span class="keyword">public</span> <span class="built_in">String</span> getTitle() {
        <span class="keyword">return</span> title;
    }
    <span class="keyword">public</span> <span class="built_in">void</span> setTitle(<span class="built_in">String</span> title) {
        <span class="keyword">this</span>.title = title;
    }
</code></pre><p>}</p>
<ul>
<li>自定义Adapter</li>
</ul>
<pre><code><span class="keyword">package</span> com.example.blogapp;
<span class="keyword">import</span> java.util.List;
<span class="keyword">import</span> android.content.Context;
<span class="keyword">import</span> android.view.LayoutInflater;
<span class="keyword">import</span> android.view.View;
<span class="keyword">import</span> android.view.ViewGroup;
<span class="keyword">import</span> android.widget.BaseAdapter;
<span class="keyword">import</span> android.widget.TextView;
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySimpleAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span></span>{
<span class="keyword">private</span> Context context;
<span class="comment">// 父列表视图容器</span>
<span class="keyword">private</span> LayoutInflater listContainer;
<span class="comment">// 新闻数据集合</span>
<span class="keyword">private</span> List&lt;Item&gt; newsDataList;
<span class="comment">// 列表项布局</span>
<span class="keyword">private</span> <span class="keyword">int</span> itemViewResource;
<span class="comment">// 列表项组件集合(title、author、count、date、flag)</span>
<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ListItemView</span> </span>{ 
    <span class="keyword">public</span> TextView title;
    <span class="keyword">public</span> TextView id;
}

<span class="javadoc">/**
 * 根据父列表构造列表项适配器，加载列表项界面、读取并设置列表项数据
 *<span class="javadoctag"> @param</span> context 父列表
 *<span class="javadoctag"> @param</span> newsDataList 列表项数据
 *<span class="javadoctag"> @param</span> itemViewResource 列表项界面布局
 */</span>
<span class="function"><span class="keyword">public</span> <span class="title">MySimpleAdapter</span><span class="params">(Context context, List&lt;Item&gt; newsDataList, <span class="keyword">int</span> itemViewResource)</span> </span>{
    <span class="keyword">this</span>.context = context;
    <span class="keyword">this</span>.listContainer = LayoutInflater.from(context);
    <span class="keyword">this</span>.itemViewResource = itemViewResource;
    <span class="keyword">this</span>.newsDataList = newsDataList;
}

<span class="javadoc">/**
 * 根据数据条目返回列表项数目
 */</span>
<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>{
    <span class="keyword">return</span> newsDataList.size();
}

<span class="function"><span class="keyword">public</span> Object <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> arg0)</span> </span>{
    <span class="keyword">return</span> <span class="keyword">null</span>;
}

<span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> arg0)</span> </span>{
    <span class="keyword">return</span> <span class="number">0</span>;
}

<span class="javadoc">/**
 * 根据位置和相关设定返回列表项
 *<span class="javadoctag"> @param</span> position 列表项起始位置
 *<span class="javadoctag"> @param</span> convertView 返回的每一个列表项
 *<span class="javadoctag"> @param</span> parent 列表项父容器
 */</span>

<span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>{

    <span class="comment">// 创建自定义列表项组件</span>
    ListItemView listItemView = <span class="keyword">null</span>;

    <span class="keyword">if</span> (convertView == <span class="keyword">null</span>) {

        <span class="comment">// 获取列表项布局（this.itemViewResource--）</span>
        convertView = listContainer.inflate(<span class="keyword">this</span>.itemViewResource, <span class="keyword">null</span>);
        <span class="comment">//初始化列表项各组件(title、author、count、date、flag)</span>
        listItemView = <span class="keyword">new</span> ListItemView();
        listItemView.title = (TextView) convertView
                .findViewById(R.id<span class="number">._</span>title);
        listItemView.id = (TextView) convertView
                .findViewById(R.id<span class="number">._</span>id);
        convertView.setTag(listItemView);

    } <span class="keyword">else</span> {
        listItemView = (ListItemView) convertView.getTag();
    }

    <span class="comment">//依次读取列表项数据中的第position项数据赋于news对象</span>
    Item news = newsDataList.get(position);
    listItemView.title.setText(news.getTitle());
    listItemView.id.setText(news.getId());
    <span class="keyword">return</span> convertView;
}
</code></pre><p>}</p>
<ul>
<li>data_list.xml</li>
</ul>
<pre><code>&lt;?xml <span class="variable">version=</span><span class="string">"1.0"</span> <span class="variable">encoding=</span><span class="string">"utf-8"</span>?&gt;
    &lt;TableLayout
        xmlns:<span class="variable">android=</span><span class="string">"http://schemas.android.com/apk/res/android"</span>
        android:<span class="variable">layout_width=</span><span class="string">"fill_parent"</span>
        android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>&gt;
    &lt;TableRow&gt;
        &lt;TextView
            android:<span class="variable">id=</span><span class="string">"@+id/_id"</span>
            android:<span class="variable">textSize=</span><span class="string">"12px"</span>    
            android:<span class="variable">gravity=</span><span class="string">"center_vertical"</span>
            android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
            android:<span class="variable">layout_width=</span><span class="string">"wrap_content"</span>/&gt;
        &lt;TextView
            android:<span class="variable">id=</span><span class="string">"@+id/_title"</span>
            android:<span class="variable">textSize=</span><span class="string">"12px"</span>
            android:<span class="variable">gravity=</span><span class="string">"center_vertical"</span>
            android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
            android:<span class="variable">layout_width=</span><span class="string">"wrap_content"</span>/&gt;
    &lt;/TableRow&gt;
&lt;/TableLayout&gt;
</code></pre><ul>
<li>main.xml文件</li>
</ul>
<pre><code>&lt;LinearLayout xmlns:<span class="variable">android=</span><span class="string">"http://schemas.android.com/apk/res/android"</span>  
    xmlns:<span class="variable">tools=</span><span class="string">"http://schemas.android.com/tools"</span>
    android:<span class="variable">orientation=</span><span class="string">"vertical"</span>
    android:<span class="variable">layout_width=</span><span class="string">"fill_parent"</span>  
    android:<span class="variable">layout_height=</span><span class="string">"fill_parent"</span>  
    tools:<span class="variable">context=</span><span class="string">".MainActivity"</span> &gt;  
    &lt;TextView 
        android:<span class="variable">layout_width=</span><span class="string">"fill_parent"</span>
        android:<span class="variable">layout_height=</span><span class="string">"wrap_content"</span>
        android:<span class="variable">text=</span><span class="string">"@string/head"</span>
        /&gt;
    &lt;ListView  
        android:<span class="variable">id=</span><span class="string">"@+id/listview"</span>  
        android:<span class="variable">layout_width=</span><span class="string">"match_parent"</span>  
        android:<span class="variable">layout_height=</span><span class="string">"match_parent"</span> &gt;  
    &lt;/ListView&gt;  
&lt;/LinearLayout&gt;  
</code></pre><ul>
<li>使用MainActivity</li>
</ul>
<pre><code><span class="keyword">package</span> com.example.blogapp;

<span class="keyword">import</span> java.util.ArrayList;

<span class="keyword">import</span> java.util.List;

<span class="keyword">import</span> android.app.Activity;
<span class="keyword">import</span> android.os.Bundle;
<span class="keyword">import</span> android.view.Menu;
<span class="keyword">import</span> android.widget.ArrayAdapter;
<span class="keyword">import</span> android.widget.ListView;

<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>{

    <span class="keyword">private</span> Item item ;
    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Item&gt; newsDataList = <span class="keyword">new</span> ArrayList&lt;Item&gt;();
    <span class="keyword">private</span> ListView listView ;
    <span class="keyword">private</span> MySimpleAdapter myadapter ;
    <span class="annotation">@Override</span>
    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{
        <span class="keyword">super</span>.onCreate(savedInstanceState);

        setContentView(R.layout.main);
        <span class="keyword">this</span>.initNewsData();
        myadapter = <span class="keyword">new</span> MySimpleAdapter(MainActivity.<span class="keyword">this</span>, newsDataList,R.layout.data_list);  
      <span class="comment">//  listView.setAdapter(adapter);  </span>
        listView =(ListView) findViewById(R.id.listview);
        listView.setAdapter(myadapter);

    }

    <span class="annotation">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>{
        <span class="comment">// Inflate the menu; this adds items to the action bar if it is present.</span>
        getMenuInflater().inflate(R.menu.main, menu);
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }
    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initNewsData</span><span class="params">()</span> </span>{
        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">20</span>; i++) {
            item = <span class="keyword">new</span> Item(<span class="string">"ID:"</span>+i,<span class="string">"标题"</span>+ i);
            newsDataList.add(item);
        }
    }

}
</code></pre><p>效果：</p>
<p><img src="/images/android/android_blog_result.png" alt="Alt text"></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-18T02:01:47.000Z"><a href="/2015/04/18/libevent-c-2/">2015-04-18</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/18/libevent-c-2/">Libevent整合protobuf （二）</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Protobuf已经下载好了，现在就开始封装一个简单的例子吧,参考官方的协议处理和封装以及编译成所需要的语言的<a href="https://developers.google.com/protocol-buffers/docs/cpptutorial?hl=zh-cn" target="_blank" rel="external">代码</a><br>定义一个简单的EchoMessage.proto<br>内容如下： </p>
<pre><code>message EchoRequest
{
    <span class="keyword">required</span> <span class="built_in">string</span> message = <span class="number">1</span>; <span class="comment">//请求字符串</span>
};
message EchoResponse
{
    <span class="keyword">required</span> <span class="built_in">string</span> response = <span class="number">1</span>; <span class="comment">//回应字符串</span>
};
</code></pre><p>测试：<br>test.cpp </p>
<pre><code><span class="preprocessor">#<span class="keyword">include</span>&lt;iostream&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;string&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> "echo.pb.h"</span>
<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;
<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>
</span>{
    <span class="built_in">string</span> s=<span class="string">"hello request"</span>;
    EchoRequest request ;
    request.set_message(s);
    <span class="built_in">cout</span>&lt;&lt;request.message()&lt;&lt;endl;
    <span class="keyword">return</span> <span class="number">1</span>;
}
</code></pre><p>编译：<br> g++ echo.pb.cc testecho.cpp -o testecho -lprotobuf<br>问题：<br>./testecho: error while loading shared libraries: libprotobuf.so.8: cannot open shared object file: No such file or directory<br>export<br>LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib<br>最后：<br>client.cpp </p>
<pre><code>    <span class="preprocessor">#<span class="keyword">include</span>&lt;stdio.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;stdlib.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;string.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;unistd.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;iostream&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;sys/types.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;sys/socket.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;netinet/in.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;arpa/inet.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> "echo.pb.h"</span>

<span class="preprocessor">#<span class="keyword">define</span> oops(msg) {\
    perror(msg); \
    exit(1); \
}  </span>
<span class="preprocessor">#<span class="keyword">define</span> SIZE 256  </span>

<span class="preprocessor">#<span class="keyword">define</span> LISTEN_PORT 9999  </span>
<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;

<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span>
</span>{


    <span class="keyword">int</span> socket_fd = socket(PF_INET, SOCK_STREAM, <span class="number">0</span>);
    <span class="keyword">if</span>(socket_fd == -<span class="number">1</span>)
        oops(<span class="string">"socket initiating error..."</span>);


    <span class="keyword">struct</span> sockaddr_in address;
    bzero(&amp;address, <span class="keyword">sizeof</span>(address));
    address.sin_family = AF_INET;
    address.sin_addr.s_addr = inet_addr(<span class="string">"127.0.0.1"</span>);
    address.sin_port =  htons(LISTEN_PORT);

    <span class="keyword">int</span> connect_result = connect(socket_fd, (<span class="keyword">struct</span> sockaddr*)&amp;address, <span class="keyword">sizeof</span>(address));
    <span class="keyword">if</span>(connect_result == -<span class="number">1</span>)
        oops(<span class="string">"connect error..."</span>);


         <span class="built_in">string</span> data;
         EchoRequest req;
         req.set_message(<span class="string">"wwwww"</span>);
         req.SerializeToString(&amp;data);
        <span class="keyword">char</span> bts[data.length()];
        <span class="built_in">strcpy</span>(bts, data.c_str());
        ssize_t write_length = write(socket_fd, bts, <span class="keyword">sizeof</span>(bts));
        <span class="keyword">if</span>(write_length &lt;= <span class="number">0</span> )
            oops(<span class="string">"error: write ..."</span>);


        <span class="keyword">char</span> buf[<span class="number">512</span>];
        bzero(buf, <span class="number">0</span>);
        ssize_t read_length = read(socket_fd, buf, <span class="keyword">sizeof</span>(buf));
        <span class="keyword">if</span>(read_length == -<span class="number">1</span>)
            oops(<span class="string">"error: read data from socket..."</span>);

        <span class="built_in">printf</span>(<span class="string">"the ret msg is: %s\n"</span>, buf);
    close(socket_fd);
    <span class="keyword">return</span> EXIT_SUCCESS;
}
</code></pre><p>最后介绍我看到过的一个架构吧：<br><img src="/images/c++/libevent.png" alt="Alt text"></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-18T01:57:53.000Z"><a href="/2015/04/18/libevent-c-1/">2015-04-18</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/18/libevent-c-1/">Libevent整合protobuf（一)</a></h1>
  

    </header>
    <div class="entry">
      
        <p>ProtocolBuffer是用于结构化数据串行化的灵活、高效、自动的方法，有如XML，不过它更小、更快、也更简单。你可以定义自己的数据结构，然后使用代码生成器生成的代码来读写这个数据结构。你甚至可以在无需</p>
<ul>
<li>下载protobuf<a href="http://code.google.com/p/protobuf/downloads/list" target="_blank" rel="external">地址</a>安装也比较简单，就不赘述。</li>
<li>当执行protoc —version成功后就表示已经安装成功了。<br>libevent是一个强大的网络库，网上的网络库有很多，想libev、boost、muduo（陈硕）写的网络库，之所以考虑libevent作为学习对象是发现公司内部好像用的很多。<br>例子代码：<br>server.cpp </li>
</ul>
<pre><code><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;stdlib.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;errno.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;assert.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;event2/event.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;event2/bufferevent.h&gt; </span>
<span class="preprocessor">#<span class="keyword">define</span> LISTEN_PORT 9999</span>
<span class="preprocessor">#<span class="keyword">define</span> LISTEN_BACKLOG 32</span>

<span class="function"><span class="keyword">void</span> <span class="title">do_accept</span><span class="params">(evutil_socket_t listener, <span class="keyword">short</span> event, <span class="keyword">void</span> *arg)</span></span>;
<span class="function"><span class="keyword">void</span> <span class="title">read_cb</span><span class="params">(<span class="keyword">struct</span> bufferevent *bev, <span class="keyword">void</span> *arg)</span></span>;
<span class="function"><span class="keyword">void</span> <span class="title">error_cb</span><span class="params">(<span class="keyword">struct</span> bufferevent *bev, <span class="keyword">short</span> event, <span class="keyword">void</span> *arg)</span></span>;
<span class="function"><span class="keyword">void</span> <span class="title">write_cb</span><span class="params">(<span class="keyword">struct</span> bufferevent *bev, <span class="keyword">void</span> *arg)</span></span>;

<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span>
</span>{

    <span class="keyword">int</span> ret;
    evutil_socket_t listener;
    listener = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>); 
    assert(listener &gt; <span class="number">0</span>); 
    evutil_make_listen_socket_reuseable(listener);

    <span class="keyword">struct</span> sockaddr_in <span class="built_in">sin</span>;
    <span class="built_in">sin</span>.sin_family = AF_INET;
    <span class="built_in">sin</span>.sin_addr.s_addr = <span class="number">0</span>;
    <span class="built_in">sin</span>.sin_port = htons(LISTEN_PORT);

    <span class="keyword">if</span> (bind(listener, (<span class="keyword">struct</span> sockaddr *)&amp;<span class="built_in">sin</span>, <span class="keyword">sizeof</span>(<span class="built_in">sin</span>)) &lt; <span class="number">0</span>) {

        perror(<span class="string">"bind"</span>);
        <span class="keyword">return</span> <span class="number">1</span>;
    }
    <span class="keyword">if</span> (listen(listener, LISTEN_BACKLOG) &lt; <span class="number">0</span>) {

        perror(<span class="string">"listen"</span>);
        <span class="keyword">return</span> <span class="number">1</span>;
    }
    <span class="built_in">printf</span> (<span class="string">"Listening...\n"</span>);

    evutil_make_socket_nonblocking(listener);

    <span class="keyword">struct</span> event_base *base = event_base_new();
    assert(base != NULL);
    <span class="keyword">struct</span> event *listen_event;
    listen_event = event_new(base, listener, EV_READ|EV_PERSIST, do_accept, (<span class="keyword">void</span>*)base);
    event_add(listen_event, NULL);
    event_base_dispatch(base);

    <span class="built_in">printf</span>(<span class="string">"The End."</span>);
    <span class="keyword">return</span> <span class="number">0</span>;
}

<span class="function"><span class="keyword">void</span> <span class="title">do_accept</span><span class="params">(evutil_socket_t listener, <span class="keyword">short</span> event, <span class="keyword">void</span> *arg)</span>
</span>{

    <span class="keyword">struct</span> event_base *base = (<span class="keyword">struct</span> event_base *)arg;
    evutil_socket_t fd;
    <span class="keyword">struct</span> sockaddr_in <span class="built_in">sin</span>;
    socklen_t slen;
    fd = accept(listener, (<span class="keyword">struct</span> sockaddr *)&amp;<span class="built_in">sin</span>, &amp;slen);
    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) {

        perror(<span class="string">"accept"</span>);
        <span class="keyword">return</span>;
    }
    <span class="keyword">if</span> (fd &gt; FD_SETSIZE) {

        perror(<span class="string">"fd &gt; FD_SETSIZE\n"</span>);
        <span class="keyword">return</span>;
    }

    <span class="built_in">printf</span>(<span class="string">"ACCEPT: fd = %u\n"</span>, fd);

    <span class="keyword">struct</span> bufferevent *bev = bufferevent_socket_new(base, fd, BEV_OPT_CLOSE_ON_FREE);
    bufferevent_setcb(bev, read_cb, NULL, error_cb, arg);
    bufferevent_enable(bev, EV_READ|EV_WRITE|EV_PERSIST);
}

<span class="function"><span class="keyword">void</span> <span class="title">read_cb</span><span class="params">(<span class="keyword">struct</span> bufferevent *bev, <span class="keyword">void</span> *arg)</span>
</span>{

<span class="preprocessor">#<span class="keyword">define</span> MAX_LINE    256</span>
    <span class="keyword">char</span> line[MAX_LINE+<span class="number">1</span>];
    <span class="keyword">int</span> n;
    evutil_socket_t fd = bufferevent_getfd(bev);

    <span class="keyword">while</span> (n = bufferevent_read(bev, line, MAX_LINE), n &gt; <span class="number">0</span>) {

        line[n] = <span class="string">'\0'</span>;
        <span class="built_in">printf</span>(<span class="string">"fd=%u, read line: %s\n"</span>, fd, line);

        bufferevent_write(bev, line, n);
    }
}
<span class="function"><span class="keyword">void</span> <span class="title">write_cb</span><span class="params">(<span class="keyword">struct</span> bufferevent *bev, <span class="keyword">void</span> *arg)</span> </span>{
}
<span class="function"><span class="keyword">void</span> <span class="title">error_cb</span><span class="params">(<span class="keyword">struct</span> bufferevent *bev, <span class="keyword">short</span> event, <span class="keyword">void</span> *arg)</span>
</span>{
    evutil_socket_t fd = bufferevent_getfd(bev);
    <span class="built_in">printf</span>(<span class="string">"fd = %u, "</span>, fd);
    <span class="keyword">if</span> (event &amp; BEV_EVENT_TIMEOUT) {

        <span class="built_in">printf</span>(<span class="string">"Timed out\n"</span>);
    }
    <span class="keyword">else</span> <span class="keyword">if</span> (event &amp; BEV_EVENT_EOF) {

        <span class="built_in">printf</span>(<span class="string">"connection closed\n"</span>);
    }
    <span class="keyword">else</span> <span class="keyword">if</span> (event &amp; BEV_EVENT_ERROR) {

        <span class="built_in">printf</span>(<span class="string">"some other error\n"</span>);
    }
    bufferevent_free(bev);
</code></pre><p>````<br>client.cpp<br>参考代码： </p>
<pre><code><span class="preprocessor">#<span class="keyword">include</span>&lt;stdio.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;stdlib.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;string.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;unistd.h&gt;</span>

<span class="preprocessor">#<span class="keyword">include</span>&lt;sys/types.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;sys/socket.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span>&lt;netinet/in.h&gt;</span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;arpa/inet.h&gt;</span>

<span class="preprocessor">#<span class="keyword">define</span> oops(msg) {\
    perror(msg); \
    exit(1); \
}  </span>
<span class="preprocessor">#<span class="keyword">define</span> SIZE 256  </span>

<span class="preprocessor">#<span class="keyword">define</span> LISTEN_PORT 9999  </span>

<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span>
</span>{


    <span class="keyword">int</span> socket_fd = socket(PF_INET, SOCK_STREAM, <span class="number">0</span>); 
    <span class="keyword">if</span>(socket_fd == -<span class="number">1</span>) 
        oops(<span class="string">"socket initiating error..."</span>);
    <span class="keyword">struct</span> sockaddr_in address;
    bzero(&amp;address, <span class="keyword">sizeof</span>(address));
    address.sin_family = AF_INET;
    address.sin_addr.s_addr = inet_addr(<span class="string">"127.0.0.1"</span>);
    address.sin_port =  htons(LISTEN_PORT);

    <span class="keyword">int</span> connect_result = connect(socket_fd, (<span class="keyword">struct</span> sockaddr*)&amp;address, <span class="keyword">sizeof</span>(address));
    <span class="keyword">if</span>(connect_result == -<span class="number">1</span>)
        oops(<span class="string">"connect error..."</span>);

    <span class="keyword">while</span>(<span class="number">1</span>)
    {

        <span class="keyword">char</span> buffer[<span class="number">256</span>] ={
            <span class="number">0</span>};
        <span class="built_in">printf</span>(<span class="string">"pls enter a string, or enter 'q' exit:\n"</span>);
        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, buffer);
        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(buffer, <span class="string">"q"</span>) == <span class="number">0</span>)
        {

            <span class="built_in">printf</span>(<span class="string">"You exit!"</span>);
            <span class="keyword">return</span> <span class="number">0</span>;
        }
        <span class="built_in">printf</span>(<span class="string">"your enter is %s\n"</span>, buffer);
        ssize_t write_length = write(socket_fd, buffer, <span class="built_in">strlen</span>(buffer)+<span class="number">1</span>);
        <span class="keyword">if</span>(write_length &lt;= <span class="number">0</span> || write_length != (<span class="built_in">strlen</span>(buffer)+<span class="number">1</span>))
            oops(<span class="string">"error: write ..."</span>);


        <span class="keyword">char</span> buf[<span class="number">512</span>];
        bzero(buf, <span class="number">0</span>);
        ssize_t read_length = read(socket_fd, buf, <span class="keyword">sizeof</span>(buf));
        <span class="keyword">if</span>(read_length == -<span class="number">1</span>)
            oops(<span class="string">"error: read data from socket..."</span>);

        <span class="built_in">printf</span>(<span class="string">"the ret msg is: %s\n"</span>, buf);
    }
    close(socket_fd);
    <span class="keyword">return</span> EXIT_SUCCESS;
}
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-17T12:39:57.000Z"><a href="/2015/04/17/mysql-learn/">2015-04-17</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/17/mysql-learn/">MySQL触发器学习</a></h1>
  

    </header>
    <div class="entry">
      
        <h4 id="MySQL触发器学习">MySQL触发器学习</h4><p>mysql创建触发器，意在监视数据库中表的插入、更新或者删除操作的时候，自动调用触发器所定义的事件进行数据库的操作：<br>触发器：<br>修改 分隔符<br>delimiter $…<br>create trigger triggerName </p>
<p>before /after </p>
<p>insert/update/delete </p>
<p>on tableName #待监视表</p>
<p>for each row #监视每一行变化</p>
<p>begin </p>
<h4 id="进行相关的触发事件的操作的处理">进行相关的触发事件的操作的处理</h4><p>declare rnum<br>set rnum </p>
<h4 id="insert_使用new取得插入新行元素">insert 使用new取得插入新行元素</h4><h4 id="delete_使用old取得待删除行元素">delete 使用old取得待删除行元素</h4><p>end $</p>
<h4 id="查看触发器：">查看触发器：</h4><p>show triggers;</p>
<h4 id="删除触发器">删除触发器</h4><h3 id="MySQL存储过程学习">MySQL存储过程学习</h3><h4 id="存储过程：封装了若干条SQL语句,起个名字保存在数据库中。存储过程可以编程完成复杂的功能。">存储过程：封装了若干条SQL语句,起个名字保存在数据库中。存储过程可以编程完成复杂的功能。</h4><h4 id="创建：">创建：</h4><p>create procedure name()</p>
<p>begin </p>
<h4 id="引入变量">引入变量</h4><p>declare age int default 80;</p>
<h4 id="变量运算">变量运算</h4><p>select age from dual;<br>set age := age+20;<br>select concat(‘20年后年龄’,age) from dual </p>
<h4 id="if_age_&gt;70_then">if age &gt;70 then</h4><p>select ‘古稀之年’<br>end$</p>
<h4 id="存储过程传递参数语法：[in/out/inout]_参数名_参数类型">存储过程传递参数语法：[in/out/inout] 参数名 参数类型</h4><p>create procedure p2(width int , height int )<br>begin </p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-17T11:42:20.000Z"><a href="/2015/04/17/php-learn/">2015-04-17</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/17/php-learn/">php单引号与双引号区别</a></h1>
  

    </header>
    <div class="entry">
      
        <p>在php中经常会输出字符串和变量的情况，但是很多时候使用单引号还是双引号会有些疑问：php中单引号的变量不会被解析，但是双引号中的变量,如果使用heredoc 会被解析：</p>
<pre><code><span class="php"><span class="preprocessor">&lt;?php</span> 
    <span class="class"><span class="keyword">class</span> <span class="title">Boo</span></span>{
    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">'zhang3'</span>;
}

<span class="variable">$a</span> = <span class="string">'wwww'</span>;
<span class="keyword">echo</span> <span class="string">'$ a'</span>;<span class="comment">//输出 $a</span>
<span class="keyword">echo</span> <span class="string">"$a"</span>;<span class="comment">//输出 wwww</span>
<span class="variable">$boo</span> = <span class="keyword">new</span> Boo();
<span class="keyword">echo</span> <span class="string">"{$boo-&gt;name}"</span>;<span class="comment">//输出zhang3</span></span>
</code></pre><p>php如果输出很长字符串可以使用heredoc，其也会象双引号一样对变量进行解析</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:yoursite.com">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/Android开发/">Android开发</a><small>4</small></li>
  
    <li><a href="/tags/Python/">Python</a><small>1</small></li>
  
    <li><a href="/tags/c-学习/">c++学习</a><small>2</small></li>
  
    <li><a href="/tags/git使用/">git使用</a><small>1</small></li>
  
    <li><a href="/tags/js学习笔记/">js学习笔记</a><small>1</small></li>
  
    <li><a href="/tags/php/">php</a><small>2</small></li>
  
    <li><a href="/tags/storm/">storm</a><small>1</small></li>
  
    <li><a href="/tags/大数据/">大数据</a><small>12</small></li>
  
    <li><a href="/tags/数据库/">数据库</a><small>1</small></li>
  
    <li><a href="/tags/网络爬虫/">网络爬虫</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Jackie wu
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>